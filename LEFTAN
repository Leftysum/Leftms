local Players = game:GetService("Players")
local lp = Players.LocalPlayer
local RunService = game:GetService("RunService")
local VirtualInput = game:GetService("VirtualInputManager")
local UserInputService = game:GetService("UserInputService")

-- Wait for PlayerGui to load
repeat task.wait() until lp:FindFirstChild("PlayerGui")

-- Remove old GUI if exists
if lp.PlayerGui:FindFirstChild("BedWarsScript") then
	lp.PlayerGui.BedWarsScript:Destroy()
end

-- Create the GUI
local gui = Instance.new("ScreenGui")
gui.Name = "BedWarsScript"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
gui.Parent = lp:WaitForChild("PlayerGui")

-- Create toggle button (top-right corner)
local openCloseButton = Instance.new("TextButton")
openCloseButton.Name = "OpenCloseButton"
openCloseButton.Size = UDim2.new(0, 50, 0, 50)
openCloseButton.Position = UDim2.new(1, -60, 0, 10)
openCloseButton.Text = "+"
openCloseButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
openCloseButton.TextColor3 = Color3.new(1, 1, 1)
openCloseButton.TextScaled = true
openCloseButton.Parent = gui

-- Main draggable frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 250, 0, 400)
mainFrame.Position = UDim2.new(0.5, -125, 0.5, -200)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Visible = false
mainFrame.Parent = gui

-- Enable mobile dragging
local dragging = false
local dragInput, dragStart, startPos

mainFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = mainFrame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

mainFrame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
									   startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)

-- Toggle GUI on button click
openCloseButton.MouseButton1Click:Connect(function()
	mainFrame.Visible = not mainFrame.Visible
	openCloseButton.Text = mainFrame.Visible and "-" or "+"
end)
